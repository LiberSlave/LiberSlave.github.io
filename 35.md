---
layout: default
title: 주식 통계 분석을 위한 엑셀 add-in 개발
---


### 그렇다면 Precision 55%를 목표로 하려면 어떻게 해야 하는가?

Precision을 직접적으로 최적화하는 것은 기술적으로 어렵습니다(Precision은 미분 가능한 함수가 아니기 때문). 하지만 목표를 달성하기 위한 훨씬 더 효과적이고 표준적인 방법이 있습니다.

#### 방법 1: scale_pos_weight 적극적으로 튜닝하기 (간접적 제어)

사용자께서 이미 사용 중인 'scale_pos_weight'가 바로 정밀도와 재현율을 조절하는 중요한 파라미터입니다.

- **scale_pos_weight 값을 높이면:** 모델이 소수 클래스(Positive, '1')의 중요도를 더 높게 평가합니다. 일반적으로 **재현율(Recall)은 올라가고 정밀도(Precision)는 떨어집니다.** (놓치지 않으려고 더 많이 '1'로 예측하므로)
    
- **scale_pos_weight 값을 낮추면:** 모델이 소수 클래스에 덜 민감해집니다. 일반적으로 **재현율은 떨어지고 정밀도는 올라갑니다.** (더 확실할 때만 '1'로 예측하므로)
    

**실행 계획:** 이 scale_pos_weight_value를 1, 3, 5, 9 (현재 값) 뿐만 아니라 0.5, 0.8 등 다양한 값으로 변경해보면서 검증 데이터셋의 Precision 변화를 관찰해야 합니다.

#### 방법 2: 예측 임계값(Threshold) 조정하기 (가장 중요하고 효과적인 방법)

이것이 **Precision을 목표치에 맞추는 가장 직접적이고 강력한 방법**입니다.

모델은 predict()를 통해 0 또는 1을 예측하지만, 그 내부 과정은 predict_proba()를 통해 각 샘플이 '1'일 확률(예: 0.65, 0.32 등)을 먼저 계산합니다. 그리고 기본적으로 이 확률이 **0.5**를 넘으면 1로, 아니면 0으로 판단합니다.

주식 예측에서는 "매수" 신호의 정확성이 중요하므로, 이 기준을 훨씬 더 까다롭게 만들어야 합니다.